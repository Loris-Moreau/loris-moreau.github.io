<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>RayTracing 3</title>
    <link rel="icon" type="image/x-icon" href="../Images/Suprise.webp">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Loris Moreau">
    <meta name="description" content="Raytracing Blog">
    <meta name="keywords" content="Showcase, Loris, Moreau, Loris Moreau, Programmer, coding adventure, Blog, Post, Raytracing, C++, CPP, Raytracing in one weekend, maths, shapes, Ray Sphere Intersection">

    <!-- Styles -->
    <link rel="stylesheet" href="../Styles/style.css">
    <link rel="stylesheet" href="../Styles/Code-Quote.css">

    <!-- Carousel script (deferred) -->
    <script src="../Scripts/Carousel.js" defer></script>
</head>

<body>
<!-- Main of the post -->
<main id="BlogPost" class="post">
    <!-- Top showcase: carousel + short intro in a flex row -->
    <header>
        <!-- ========== Section 1 Navbar ========== -->
        <nav style="margin: 0 auto 2em auto;">
            <ul>
                <li><a href="../Blog.html">Back</a></li>
                <li><a href="../index.html" target="_blank">Main</a></li>
                <li><a href="../Blog.html" target="_blank">Blog</a></li>
                <li><a href="../Resources.html" target="_blank">Resources</a></li>
            </ul>
        </nav>

        <div class="flex-container">
            <img width="40%" loading="lazy" src="../Images/RayTracing/Final%20Render%20(B1).webp" alt="Final Result of book 1" />
            
            <!-- Intro / author column -->
            <div class="text-container">
                <h1>Raytracing in one weekend in C++</h1>
                <p>Welcome to my adventure following the
                    <a href="https://raytracing.github.io/" target="_blank">Ray Tracing in One Weekend</a> series in C++.</p>

                <p>
                    <a target="_blank" href="https://github.com/Loris-Moreau/RayTracing" class="cta-button">GitHub Repository</a>
                </p>
            </div>
        </div>
    </header>

    <!-- Part 3: Intro -->
    <section>
        <div>
            <h2 class="underline" style="text-decoration-color: dodgerblue">Part 3 <i>(Time for Maths)</i></h2>
            <h2 class="underline" style="text-decoration-color: royalblue">Now to add shapes</h2>
            <p>Let's start with spheres — the easiest shape to test for ray intersections.</p>
        </div>
    </section>

    <!-- Ray-Sphere explanation -->
    <section>
        <h2 class="underline" style="text-decoration-color: royalblue">Ray-Sphere Intersection</h2>

        <p>A sphere centered at the world origin satisfies:</p>
        <p><b style="color: red">X</b><sup>2</sup> + <b style="color: limegreen">Y</b><sup>2</sup> + <b style="color: dodgerblue">Z</b><sup>2</sup> = r<sup>2</sup></p>

        <p>Points with &lt; r<sup>2</sup> are inside; &gt; r<sup>2</sup> are outside.</p>

        <h3>Displacing the sphere</h3>
        <p>If the sphere center is <code>C = (C<sub style="color: red">x</sub>, C<sub style="color: limegreen">y</sub>, C<sub style="color: dodgerblue">z</sub>)</code> the equation becomes:</p>
        <p>(X - C<sub>x</sub>)<sup>2</sup> + (Y - C<sub>y</sub>)<sup>2</sup> + (Z - C<sub>z</sub>)<sup>2</sup> = r<sup>2</sup></p>

        <p>Using vectors, the surface points satisfy <code>(P - C) · (P - C) = r<sup>2</sup></code>.</p>
    </section>

    <!-- DOT product and derivation -->
    <section>
        <h2 class="underline" style="text-decoration-color: royalblue">DOT Product & Derivation</h2>

        <p>Ray parametric form: <code>P(t) = O + t·d</code>. We ask whether there exists <code>t</code> such that <code>(P(t)-C)·(P(t)-C) = r²</code>.</p>

        <p>Substitute: <code>((O + t·d) - C)·((O + t·d) - C) = r²</code>. Expand and group by powers of <code>t</code>:</p>

        <p><code>t² (d·d) + 2 t (d·(O - C)) + (O - C)·(O - C) - r² = 0</code></p>

        <p>This is a quadratic in <code>t</code>. Solve with the quadratic formula:</p>

        <p><em>a = d·d</em>, <em>b = 2 d·(O - C)</em>, <em>c = (O - C)·(O - C) - r²</em></p>

        <figure>
            <img width="42%" loading="lazy" src="../Images/RayTracing/CircleIntersection.webp" alt="Circle Intersection" />
            <figcaption><a href="#" target="_blank">img. Source</a></figcaption>
        </figure>
    </section>

    <!-- Quadratic explanation -->
    <section>
        <h2 class="underline" style="text-decoration-color: cadetblue">Quadratic Solve</h2>

        <p>Discriminant <code>Δ = b² − 4ac</code> determines intersections:</p>
        <ul>
            <li><code>Δ &gt; 0</code> → two real intersections (ray hits sphere twice)</li>
            <li><code>Δ = 0</code> → one tangent intersection</li>
            <li><code>Δ &lt; 0</code> → no real intersections</li>
        </ul>
    </section>

    <!-- Code: HitSphere + RayColor -->
    <section>
        <h2 class="underline" style="text-decoration-color: royalblue">Testing: hard-coded hit test</h2>

        <div class="snippet">
            <div class="Swindow">
                <div class="Swindow-title"><p>Raytracing.cpp</p></div>
                <div class="Sconsole">
<pre><code>bool HitSphere(const Position& rCenter, double radius, const Ray& rRay)
{
   Vector3 oC = rRay.GetOrigin() - rCenter;
   double a = Dot(rRay.GetDirection(), rRay.GetDirection());
   double b = 2.0 * Dot(oC, rRay.GetDirection());
   double c = Dot(oC, oC) - radius * radius;

   double discriminant = b * b - 4 * a * c;
   return (discriminant >= 0);
}

Color RayColor(const Ray& rRay)
{
   if(HitSphere(Position(0, 0, -1), 0.5, rRay))
       return Color(1, 0, 0);
   Vector3 unitDirection = Unit(rRay.GetDirection());
   double blue = 0.5 * (unitDirection.y + 1.0);
   return (1.0 - blue) * Color(1.0, 1.0, 1.0) + blue * Color (0, 0, 1.0);
}</code></pre>
                </div>
            </div>
        </div>

        <p>You should now see a red sphere on the background gradient. This simple test allows negative <code>t</code> (behind camera) — we'll clamp that later.</p>
    </section>

    <!-- Next steps -->
    <section>
        <h2 class="underline" style="text-decoration-color: cadetblue">What's next</h2>
        <p>Next post: add shading, normals, and limit <code>t</code> to the visible ray segment (ignore negative solutions).</p>
    </section>

    <footer>
        <p style="color: var(--text-color-bright);">17-01-2024</p>
    </footer>
</main>

<!-- Navigation buttons -->
<div style="text-align:center; margin-top:1rem">
    <a href="RayTracing-2.html" class="cta-button">Previous</a>
    <a href="../Blog.html" class="cta-button secondary" style="margin:0 0.75rem">Entries</a>
    <a href="RayTracing-4.html" class="cta-button">Next</a>
</div>

</body>
</html>
